<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons.css" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>


<div>

    <div align="left">
    </div>

    <div align="left">
        <p>
            You are about to submit this data to a webulous server.
        </p>    
        <p style="text-align: center;font-style: italic;"><?= getTemplateServerURL(); ?>. </p>
        <p>    
            Please provide any additional notes on this submission along with your URIGen API key if required
        </p>
        <table>
            <tr>
                <td style="padding-right:3px;">
                    Message:
                </td>
                <td align="right">
                    <input  size="35" class="message" type="text" placeholder="Enter submission message here"/>
                </td>
            </tr>
            <tr>
                <td style="padding-right:3px;">
                    URIGen API Key:
                </td>
                <td align="right">
                    <input  size="35" class="apikey" type="text" placeholder="optional"/>
                </td>
            </tr>
            <tr>
                <td align="left" style="padding-right:5px;">
                    <table>
                        <tr>
                            <td style="padding-right:3px;">
                                <input class="submitTemplateButton action" type="button" value="Submit" onclick="submit()"/>
                            </td>
                            <td><input type="button" value="Cancel" onclick="google.script.host.close();" /></td>
                        </tr>
                    </table>
                </td>
                <td>
                    <div class="loading" style="display:none;">
                        <img style="height:30px;width:30px;" src="https://5079980847011989849-a-1802744773732722657-s-sites.googlegroups.com/site/scriptsexamples/ProgressSpinner.gif"/>
                        Submitting data, please wait...
                    </div>
                    <div class="errorMessage" style="display:none; color:red;">Failed to submit data</div>
               </td>
            </tr>
        </table>





    </div>
</div>

<script>


    function submit () {
        $("div.loading").show();
        //$("div.loading").css("visibility", "visible");
        google.script.run.withFailureHandler(onFailure).withSuccessHandler(onSuccess).submitData($('.message').val(), $('.apikey').val());
    }

    function onFailure(error){
        $("div.loading").hide();
        //$("div.loading").css("visibility", "hidden");
        $('.errorMessage').text(error).show();
    }

    function onSuccess(){
        $("div.loading").hide();;
        //$("div.loading").css("visibility", "hidden");
        google.script.host.close();
    }




</script>