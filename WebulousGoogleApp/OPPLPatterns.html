<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons.css" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>


<div>
    <div>
        <b>Pick your patterns</b> <br>
        <table>
            <tr> <td>
                <? var source = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("SourceData");
            var max = source.getLastColumn();
            var data = source.getRange(1, 3, 2, max-2).getValues();
           ?>

                <table id='patternOptions'>
                    <? for(var s=0; s<data[0].length; s++){
            var chked = data[0][s];
            var name = data[1][s];
            var id = 3+s;

            if(chked == ""){?>

                    <tr><td style="width:250px"><input type="checkbox" value="<?=id;?>"/> <?= name; ?> </td>
                        <?}
            else{ ?>
                    <tr><td style="width:250px"><input type="checkbox" value="<?=id;?>" checked="true"/> <?= name; ?> </td>
                        <? }?>

                        <td><input type="button" value="View pattern" onclick="google.script.run.withSuccessHandler(onSuccess).displayPattern(<?=id;?>)" /></td></tr>
                    <? } ?>
                </table></td>
                <td style="width:300px">
                    <div class="patternDisplay" style="margin-left: 30px"> </div>
                </td></tr>
            <tr>
                <td>     <input type="button" value="Save selection" onclick="getChecked()" /> </td>
                <td>     <input type="button" value="Assign variables" onclick="getCheckedVars()" /> </td>
                <td>     <input type="button" value="Cancel" onclick="google.script.host.close()" />  </td>
            </tr>
        </table>

    </div>
 </div>

    <script>

        function onSuccess(html){
            $("div.patternDisplay").html(html);
        }

        function onOtherSuccess(){
            google.script.host.close();
        }


        function getChecked(){
            var form = document.getElementById('patternOptions');
            var chks = form.querySelectorAll('input[type="checkbox"]');
            var checked = [];

            for(var i = 0; i < chks.length; i++){
                if(chks[i].checked){
                    checked.push(chks[i].value);
                }
            }

            if(checked.length == 0){
                google.script.run.noPatternSelected();
            }
            else{
                google.script.run.withSuccessHandler(onOtherSuccess).setPatternSelection(checked);
            }

        }


        function getCheckedVars(){
            var form = document.getElementById('patternOptions');
            var chks = form.querySelectorAll('input[type="checkbox"]');
            var checked = [];

            for(var i = 0; i < chks.length; i++){
                if(chks[i].checked){
                    checked.push(chks[i].value);
                }
            }

            if(checked.length == 0){
                google.script.run.noPatternSelected();
            }
            else{
                google.script.run.getVariableSelector(checked);
            }

        }

    </script>